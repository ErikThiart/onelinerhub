# How to load ML model from file

```python
import pickle
from sklearn import datasets, linear_model

X, y = datasets.load_diabetes(return_X_y=True)
model = pickle.load(open('/tmp/model.ml', 'rb'))

y_pred = model.predict(X)
```

- `from sklearn import` - import module from [lib:scikit-learn](https://onelinerhub.com/python-scikit-learn/how-to-install-scikit-learn-using-pip)
- `datasets.load_diabetes` - loads sample [diabetes](https://scikit-learn.org/stable/modules/generated/sklearn.datasets.load_diabetes.html) database
- `pickle.load(` - loads data from given file
- `open(` - opens file descriptor (for reading in our case)
- `/tmp/model.ml` - path to file to load model from
- `.predict(` - predict target variable based on given features dataset

group: load-save

## Example: 
```python
import pickle
from sklearn import datasets, linear_model

X, y = datasets.load_diabetes(return_X_y=True)
model = pickle.load(open('/tmp/model.ml', 'rb'))

y_pred = model.predict(X)
print(y_pred)
```
```
[201.25614867  67.14322125 169.94489927 160.04057237 124.66422827
 106.01053866  73.26128224 125.51130262 154.24370722 213.09914932
  89.87188249  85.00759701 113.67451735 164.16346454 105.01909888
 177.32398579 212.58948311 183.12962287 137.73998175 125.17065118
 110.78357505  83.5733446  112.60505786 250.22499487 158.27974941
 142.92280868  86.62058586 167.90861014 126.22730393 184.00293239
 156.89218219  67.50449973 233.10791142 101.68974294  71.30759726
  91.28001245 213.02683392 152.47167698 245.22984279 135.72169597
 148.11373143  59.40205945 137.36837371  72.55021238 209.4089989
 124.40168066 141.47695472 102.85027634  74.84344663 178.73844966
 149.55865775 162.82480931 133.599315   147.88730951 138.87257994
  63.4490606  200.72583596  71.55375822 102.94768105 140.60626311
 108.4126069  161.23913188  60.01905043 101.58207859 104.36522464
 178.93590456 131.11299706 120.10558869 105.02647884 107.07259967
  64.09313972 233.054254   161.07235124 121.84247377 151.68756262
 122.08597199 177.94596541  68.88708174 160.40744842  85.55194463
 178.15848124 115.37172141  67.12184162 145.89463209  56.16265882
 169.06751246  35.53167692 162.45725671  69.46956581  99.81726611
  73.9727156  185.27700493 189.75161534  60.50133272 109.48309399
 113.50966685 201.18514118 201.40857746 129.70238849 135.42265193
 171.90146904 104.62614126 154.6740359  160.00257752 152.30556502
 105.81320309  70.66080058 141.27399395 215.40705789 124.8372044
  28.9823953  124.26876649 147.32717879 199.90608972 292.77411178
 185.80943262 207.05982184 220.53537108 159.36545845 144.0812862
 146.0644628  190.2752023  211.91497908 161.37313562 162.84395216
 187.33243946  56.36050885 121.18617435  94.82347854 193.20909136
 239.9308302   71.2380486  113.66620432  59.03798685 143.53800427
 220.09225806  52.26382604 229.44814226 244.54863164 247.05842257
 148.72754592 201.64064473 179.85270261 119.12788674 168.66036512
 239.6390428  186.52589756 220.51166113 116.51013775 169.08993456
 199.62875594 140.54254397 183.81503436 116.85228881 151.16375066
 203.6411477  141.60413928 121.10557804  82.31798901 236.94709481
  80.32451189 233.66845082 133.17023685 188.75798934 145.89279357
  66.7979434   56.29857974 251.90925787 210.58270032 228.32256102
  43.90986375  78.41366243 218.42706898  93.27850513 154.33614198
 112.19269751 156.33345746 210.8697023  100.06258628 160.23308144
 172.19891816  91.8316949  170.31354511 151.25192219 192.04867106
 184.26046724 191.47087599  64.73895159 158.86344344 108.92301576
 183.64224294 121.0886075   99.90241382 138.42840899 146.08386306
 165.73675656  92.89928439 180.30405353 139.25589151 184.33484367
  92.08877446  65.40282089 183.98930858 190.12001553 159.56538196
 225.7578099  156.67685712 213.42196755 204.93689751 160.00313319
 134.64612393 171.82912503 154.58003024  95.01553296  93.71927198
 251.23890091 205.10729567 220.39228912 122.68495751 136.17073544
  52.17262051 138.00675269 148.98912486 118.26484514  67.70233926
 222.28435706  80.43537314 104.08500447 113.63140009  99.39570925
 174.47386448 152.99388252 152.12409825 137.30676048 227.39854112
 160.32958811 187.59877342  59.69586424 174.4270775  183.54672799
 226.94016151 113.88092312  81.37273513  94.76516187 134.5384768
  99.04149415 131.48668071  85.30249906 232.97223421 246.57828022
 259.80610838 270.64375354 173.46003595 195.57282407 254.98359275
 113.23641822 254.64469047 107.65483647  96.10704485 130.37739526
  55.55330467 128.38298203 261.57467586  40.92538053 116.81520693
 127.62419745  34.50548782 135.12121133 230.34211533  95.12155666
 188.50046297 155.80918545 142.4926711  197.3088738  168.88049053
 147.95398505 206.20080421 107.5449094   99.94122319 117.05618332
 166.95432432  91.1412441  137.22179985  76.37327793 154.06043328
 186.52877027  70.17821182 155.18073418  81.06455735 194.19310369
 213.04175046 216.07534892  86.24703842 176.52809287  79.9668042
 156.41394559  72.42148995  94.23524848  96.8707453  114.25883952
 210.39822027 122.3507337  203.1801313  240.0157868  121.62138239
 126.90841373 124.85985061 138.40145062  82.7751515  142.5889491
 195.28669291 165.574264   120.8720422  213.98689936 169.87441001
 111.19522346 192.87850989 167.66496419 160.99968813 182.1601431
 188.08462324 268.4655737  266.72140958 216.3676676  201.26463353
 211.32462302 146.80399164 221.29592545 176.72744754  97.06376277
 164.17656838  97.53032462 281.35712266 172.52853377  74.87151254
  85.49393998 236.79522006 165.38444951 121.98081573 151.01815476
 170.95742155 180.71753301 159.48935905 155.26696557 143.67226968
 122.42850823 187.87244963 100.21006363 124.96698785  78.96357567
 245.0934616   79.19994868  56.22779698 174.04570757 203.27180627
 124.30296202  95.95882835 206.66720332  48.16035857 163.19068737
 185.66962866 111.42985766 226.02996658 152.65266215 143.7949852
 150.74675892 249.71540956 254.84266797 193.62725796 170.44845152
  57.09004004 208.63805233 109.44317698 131.02876669 123.8723468
 181.60226413 213.53151911 164.80853389 160.83196874 119.85855261
 166.09371928  69.81688496 245.81788723 110.81038901 126.57198523
 133.04664622 103.3542639   83.62040212 164.52769453  79.37686713
 255.61050298  44.38459717  92.69053876  95.85640182 260.09095982
 167.90698157  55.85780622 171.96727491 180.02321269 190.90772973
 180.23252755  77.98068479 130.02943843 247.14415279 195.17242381
 272.67892821  51.40121493 162.31376411 199.35008841 172.3653101
 166.32540309 145.37262277 221.65121322 118.4270201  167.01717916
 159.22331726 218.05832298 143.01423635 103.16333403  67.06744939
 123.55548031 186.20442829 213.32199566 145.12077551 161.1356108
 103.41074641 155.14418966 118.53043749 251.01364116 105.0220507
 108.29042686 116.32776642 212.14262483  59.61007139 127.05330168
 113.11627511  51.13883479 192.56258923  97.35387479 112.79222048
 209.84123518  53.93562223]

```

